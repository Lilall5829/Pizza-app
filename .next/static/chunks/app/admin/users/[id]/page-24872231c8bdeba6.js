(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[214],{5248:function(e,s,a){Promise.resolve().then(a.bind(a,6077))},2489:function(e,s,a){"use strict";a.d(s,{Z:function(){return t}});let t=(0,a(9763).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},3334:function(e,s,a){"use strict";a.d(s,{F_:function(){return x},WG:function(){return d},aF:function(){return c},fx:function(){return m},vM:function(){return o}});var t=a(5526),r=a(6593),l=a(9827),i=a(1770),n=a(9064);let d=()=>(0,r.a)({queryKey:["users"],queryFn:async()=>{let{data:e,error:s}=await t.O.from("profiles").select("\n          id,\n          full_name,\n          username,\n          group,\n          updated_at,\n          phone,\n          default_address,\n          default_city,\n          default_province,\n          default_postal_code,\n          default_country\n        ").order("updated_at",{ascending:!1});if(s)throw Error(s.message);return e}}),c=e=>(0,r.a)({queryKey:["users",e],queryFn:async()=>{let{data:s,error:a}=await t.O.from("profiles").select("*").eq("id",e).single();if(a)throw Error(a.message);return s},enabled:!!e}),o=()=>{let e=(0,l.NL)();return(0,i.D)({mutationFn:async e=>{let{userId:s,role:a}=e,{data:r,error:l}=await t.O.from("profiles").update({group:a,updated_at:new Date().toISOString()}).eq("id",s).select();if(l)throw l;if(!r||0===r.length)throw Error("User not found or you don't have permission to update this user");return r[0]},onSuccess:()=>{e.invalidateQueries({queryKey:["users"]}),n.ZP.success("User role updated successfully!")},onError:e=>{n.ZP.error(e.message||"Failed to update user role")}})},x=()=>{let e=(0,l.NL)();return(0,i.D)({mutationFn:async e=>{let{error:s}=await t.O.from("profiles").delete().eq("id",e);if(s)throw s;return{userId:e}},onSuccess:()=>{e.invalidateQueries({queryKey:["users"]}),n.ZP.success("User deleted successfully!")},onError:e=>{n.ZP.error(e.message||"Failed to delete user")}})},m=()=>(0,r.a)({queryKey:["users","stats"],queryFn:async()=>{let{data:e,error:s}=await t.O.from("profiles").select("group");if(s)throw s;let{count:a,error:r}=await t.O.from("orders").select("*",{count:"exact",head:!0});if(r)throw r;return{totalUsers:e.length,adminUsers:e.filter(e=>"ADMIN"===e.group).length,customerUsers:e.filter(e=>"ADMIN"!==e.group).length,totalOrders:a||0}}})},6077:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return w}});var t=a(7437),r=a(3334),l=a(9295),i=a(1192),n=a(9763);let d=(0,n.Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),c=(0,n.Z)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),o=(0,n.Z)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),x=(0,n.Z)("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),m=(0,n.Z)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);var h=a(4630);let u=(0,n.Z)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);var p=a(2489),y=a(8906),f=a(2369);let g=(0,n.Z)("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]);var j=a(7648),N=a(9376),v=a(2265),b=a(9064);function w(){var e,s,a,n;let{session:w,loading:k,isAdmin:_}=(0,i.a)(),Z=(0,N.useParams)().id,[M,S]=(0,v.useState)(!1),[A,U]=(0,v.useState)(""),{data:C,isLoading:D,error:O}=(0,r.aF)(Z),{mutate:q,isPending:F}=(0,r.vM)();return((0,v.useEffect)(()=>{k||w||(0,N.redirect)("/sign-in"),k||!w||_||(0,N.redirect)("/")},[w,k,_]),(0,v.useEffect)(()=>{C&&!M&&U(C.group||"CUSTOMER")},[C,M]),k||D)?(0,t.jsxs)("div",{className:"min-h-screen",children:[(0,t.jsx)(l.h,{}),(0,t.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-500"})})]}):w&&_?O||!C?(0,t.jsxs)("div",{className:"min-h-screen",children:[(0,t.jsx)(l.h,{}),(0,t.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"User Not Found"}),(0,t.jsx)("p",{className:"text-gray-600 mb-4",children:(null==O?void 0:O.message)||"The requested user could not be found."}),(0,t.jsx)(j.default,{href:"/admin/users",className:"bg-primary-600 text-white px-4 py-2 rounded-md hover:bg-primary-700 transition-colors",children:"Back to Users"})]})})]}):(0,t.jsxs)("div",{className:"min-h-screen",children:[(0,t.jsx)(l.h,{}),(0,t.jsxs)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,t.jsx)("div",{className:"mb-8",children:(0,t.jsx)("div",{className:"flex items-center justify-between",children:(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsx)(j.default,{href:"/admin/users",className:"p-2 text-gray-600 hover:text-gray-900 transition-colors",children:(0,t.jsx)(d,{className:"h-5 w-5"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"User Details"}),(0,t.jsx)("p",{className:"mt-2 text-gray-600",children:"Comprehensive user information and activity"})]})]})})}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,t.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,t.jsxs)("div",{className:"bg-white shadow rounded-lg",children:[(0,t.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Basic Information"})}),(0,t.jsx)("div",{className:"p-6",children:(0,t.jsxs)("div",{className:"flex items-start space-x-6",children:[(0,t.jsx)("div",{className:"flex-shrink-0",children:(0,t.jsx)("div",{className:"h-20 w-20 rounded-full bg-gray-300 flex items-center justify-center",children:(0,t.jsx)("span",{className:"text-2xl font-medium text-gray-700",children:(null===(s=C.full_name)||void 0===s?void 0:null===(e=s.charAt(0))||void 0===e?void 0:e.toUpperCase())||(null===(n=C.username)||void 0===n?void 0:null===(a=n.charAt(0))||void 0===a?void 0:a.toUpperCase())||"U"})})}),(0,t.jsxs)("div",{className:"flex-1 space-y-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-500",children:"Full Name"}),(0,t.jsx)("p",{className:"mt-1 text-lg text-gray-900",children:C.full_name||"Not provided"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-500",children:"Username"}),(0,t.jsx)("p",{className:"mt-1 text-lg text-gray-900",children:C.username||"Not set"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-500",children:"User ID"}),(0,t.jsx)("p",{className:"mt-1 text-sm text-gray-700 font-mono",children:C.id})]})]})]})})]}),(0,t.jsxs)("div",{className:"bg-white shadow rounded-lg",children:[(0,t.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Contact Information"})}),(0,t.jsx)("div",{className:"p-6",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)(c,{className:"h-5 w-5 text-gray-400"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-500",children:"Phone"}),(0,t.jsx)("p",{className:"mt-1 text-gray-900",children:C.phone||"Not provided"})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)(o,{className:"h-5 w-5 text-gray-400"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-500",children:"Email"}),(0,t.jsx)("p",{className:"mt-1 text-gray-900",children:"Available via auth system"})]})]})]})})]}),(C.default_address||C.default_city)&&(0,t.jsxs)("div",{className:"bg-white shadow rounded-lg",children:[(0,t.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Default Address"})}),(0,t.jsx)("div",{className:"p-6",children:(0,t.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,t.jsx)(x,{className:"h-5 w-5 text-gray-400 mt-1"}),(0,t.jsxs)("div",{className:"space-y-1",children:[C.default_address&&(0,t.jsx)("p",{className:"text-gray-900",children:C.default_address}),C.default_city&&(0,t.jsx)("p",{className:"text-gray-900",children:[C.default_city,C.default_province,C.default_postal_code].filter(Boolean).join(", ")}),C.default_country&&(0,t.jsx)("p",{className:"text-gray-600",children:C.default_country})]})]})})]}),(0,t.jsxs)("div",{className:"bg-white shadow rounded-lg",children:[(0,t.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Account Activity"})}),(0,t.jsx)("div",{className:"p-6",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)(m,{className:"h-5 w-5 text-gray-400"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-500",children:"Member Since"}),(0,t.jsx)("p",{className:"mt-1 text-gray-900",children:C.updated_at?new Date(C.updated_at).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"Unknown"})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)(m,{className:"h-5 w-5 text-gray-400"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-500",children:"Last Updated"}),(0,t.jsx)("p",{className:"mt-1 text-gray-900",children:C.updated_at?new Date(C.updated_at).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"Unknown"})]})]})]})})]})]}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"bg-white shadow rounded-lg",children:[(0,t.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Role Management"}),!M&&Z!==w.user.id&&(0,t.jsx)("button",{onClick:()=>S(!0),className:"text-indigo-600 hover:text-indigo-900",children:(0,t.jsx)(h.Z,{className:"h-4 w-4"})})]})}),(0,t.jsx)("div",{className:"p-6",children:M?(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-500 mb-2",children:"Select Role"}),(0,t.jsxs)("select",{value:A,onChange:e=>U(e.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-primary-500 focus:border-primary-500",disabled:F,children:[(0,t.jsx)("option",{value:"CUSTOMER",children:"Customer"}),(0,t.jsx)("option",{value:"ADMIN",children:"Administrator"})]})]}),(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsxs)("button",{onClick:()=>{if(Z===w.user.id&&"ADMIN"!==A){b.ZP.error("You cannot change your own admin role!");return}q({userId:Z,role:A},{onSuccess:()=>{S(!1),b.ZP.success("User role updated successfully!")}})},disabled:F,className:"flex items-center space-x-2 bg-green-600 text-white px-3 py-2 rounded-md hover:bg-green-700 transition-colors disabled:opacity-50",children:[(0,t.jsx)(u,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:F?"Saving...":"Save"})]}),(0,t.jsxs)("button",{onClick:()=>{S(!1),U(C.group||"CUSTOMER")},disabled:F,className:"flex items-center space-x-2 border border-gray-300 text-gray-700 px-3 py-2 rounded-md hover:bg-gray-50 transition-colors",children:[(0,t.jsx)(p.Z,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"Cancel"})]})]})]}):(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"flex-shrink-0",children:"ADMIN"===C.group?(0,t.jsx)(y.Z,{className:"h-6 w-6 text-red-500"}):(0,t.jsx)(f.Z,{className:"h-6 w-6 text-green-500"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-lg font-medium text-gray-900",children:"ADMIN"===C.group?"Administrator":"Customer"}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"ADMIN"===C.group?"Full access to admin panel and all features":"Standard customer access"})]})]})})]}),(0,t.jsxs)("div",{className:"bg-white shadow rounded-lg",children:[(0,t.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Quick Stats"})}),(0,t.jsx)("div",{className:"p-6",children:(0,t.jsx)("div",{className:"space-y-4",children:(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)(g,{className:"h-5 w-5 text-gray-400"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-500",children:"Total Orders"}),(0,t.jsx)("p",{className:"mt-1 text-2xl font-bold text-gray-900",children:"--"}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:"Order history feature to be implemented"})]})]})})})]}),(0,t.jsxs)("div",{className:"bg-white shadow rounded-lg",children:[(0,t.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Account Status"})}),(0,t.jsx)("div",{className:"p-6",children:(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-gray-500",children:"Account Active"}),(0,t.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Active"})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm text-gray-500",children:"Profile Complete"}),(0,t.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(C.full_name&&C.phone&&C.default_address?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"),children:C.full_name&&C.phone&&C.default_address?"Complete":"Partial"})]})]})})]})]})]})]})]}):null}},9295:function(e,s,a){"use strict";a.d(s,{h:function(){return x}});var t=a(7437),r=a(3896),l=a(9099),i=a(3247),n=a(6275),d=a(2369),c=a(8293),o=a(7648);function x(){let{session:e,isAdmin:s}=(0,r.a)(),{items:a}=(0,l.j)(),x=a.reduce((e,s)=>e+s.quantity,0);return(0,t.jsx)("header",{className:"bg-white shadow-sm border-b",children:(0,t.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,t.jsxs)("div",{className:"flex items-center justify-between h-16",children:[(0,t.jsx)(o.default,{href:"/",className:"flex items-center",children:(0,t.jsx)("div",{className:"text-2xl font-bold text-primary-600",children:"\uD83C\uDF54 Food Ordering"})}),(0,t.jsxs)("nav",{className:"hidden md:flex items-center space-x-8",children:[(0,t.jsx)(o.default,{href:"/",className:"text-gray-700 hover:text-primary-600 transition-colors",children:"Home"}),(0,t.jsx)(o.default,{href:"/menu",className:"text-gray-700 hover:text-primary-600 transition-colors",children:"Menu"}),e&&(0,t.jsx)(o.default,{href:"/orders",className:"text-gray-700 hover:text-primary-600 transition-colors",children:"My Orders"}),s&&(0,t.jsx)(o.default,{href:"/admin",className:"text-gray-700 hover:text-primary-600 transition-colors",children:"Admin"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsx)("button",{className:"p-2 text-gray-700 hover:text-primary-600 transition-colors",children:(0,t.jsx)(i.Z,{className:"w-5 h-5"})}),(0,t.jsxs)(o.default,{href:"/cart",className:"p-2 text-gray-700 hover:text-primary-600 transition-colors relative",children:[(0,t.jsx)(n.Z,{className:"w-5 h-5"}),x>0&&(0,t.jsx)("span",{className:"absolute -top-1 -right-1 bg-primary-600 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center",children:x})]}),e?(0,t.jsx)(o.default,{href:"/profile",className:"p-2 text-gray-700 hover:text-primary-600 transition-colors",children:(0,t.jsx)(d.Z,{className:"w-5 h-5"})}):(0,t.jsx)(o.default,{href:"/sign-in",className:"bg-primary-600 text-white px-4 py-2 rounded-md hover:bg-primary-700 transition-colors",children:"Sign In"}),(0,t.jsx)("button",{className:"md:hidden p-2 text-gray-700 hover:text-primary-600 transition-colors",children:(0,t.jsx)(c.Z,{className:"w-5 h-5"})})]})]})})})}},1192:function(e,s,a){"use strict";a.d(s,{Providers:function(){return c},a:function(){return r.a},j:function(){return l.j}});var t=a(7437),r=a(3896),l=a(9099),i=a(2979),n=a(9827),d=a(2265);function c(e){let{children:s}=e,[a]=(0,d.useState)(()=>new i.S({defaultOptions:{queries:{staleTime:6e4,gcTime:6e5}}}));return(0,t.jsx)(n.aH,{client:a,children:(0,t.jsx)(r.Z,{children:(0,t.jsx)(l.Z,{children:s})})})}}},function(e){e.O(0,[215,33,648,419,99,971,117,744],function(){return e(e.s=5248)}),_N_E=e.O()}]);
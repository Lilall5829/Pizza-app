(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[285],{3252:function(e,s,r){Promise.resolve().then(r.bind(r,659))},659:function(e,s,r){"use strict";r.r(s),r.d(s,{default:function(){return x}});var t=r(7437),a=r(1192),l=r(2265),d=r(389);function i(e){let{onAddressSelected:s,onCancel:r}=e,{profile:i}=(0,a.a)(),[n,c]=(0,l.useState)("select"),o=null==i?void 0:i.default_address;return"new"===n?(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Enter Delivery Address"}),o&&(0,t.jsx)("button",{onClick:()=>c("select"),className:"text-sm text-primary-600 hover:text-primary-700",children:"← Back to address selection"})]}),(0,t.jsx)(d.Z,{initialData:i?{customerName:i.full_name||"",phone:i.phone||"",city:i.default_city||"",province:i.default_province||"ON",country:i.default_country||"Canada"}:{},onSubmit:s,onCancel:o?()=>c("select"):r,submitText:"Use This Address"})]}):(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Select Delivery Address"}),o?(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("div",{className:"border border-gray-200 rounded-lg p-4 hover:border-primary-300 transition-colors",children:(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("div",{className:"flex items-center gap-2 mb-2",children:(0,t.jsx)("span",{className:"text-sm font-medium text-primary-600 bg-primary-50 px-2 py-1 rounded",children:"Default Address"})}),(0,t.jsx)("p",{className:"font-medium text-gray-900",children:i.full_name||"Your Name"}),(0,t.jsx)("p",{className:"text-gray-600",children:[i.default_address,i.default_city,i.default_province,i.default_postal_code].filter(Boolean).join(", ")}),i.phone&&(0,t.jsxs)("p",{className:"text-gray-600",children:["\uD83D\uDCDE ",i.phone]})]}),(0,t.jsx)("button",{onClick:()=>{i&&s({customerName:i.full_name||"",phone:i.phone||"",address:i.default_address||"",city:i.default_city||"",province:i.default_province||"ON",postalCode:i.default_postal_code||"",country:i.default_country||"Canada",instructions:""})},className:"ml-4 bg-primary-600 text-white px-4 py-2 rounded-md hover:bg-primary-700 transition-colors",children:"Use This Address"})]})}),(0,t.jsx)("div",{className:"border border-gray-200 rounded-lg p-4 hover:border-primary-300 transition-colors",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium text-gray-900",children:"➕ Use a different address"}),(0,t.jsx)("p",{className:"text-gray-600 text-sm",children:"Enter a new delivery address for this order"})]}),(0,t.jsx)("button",{onClick:()=>c("new"),className:"ml-4 border border-gray-300 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-50 transition-colors",children:"Enter New Address"})]})})]}):(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("p",{className:"text-gray-600",children:"You don't have a default address saved yet."}),(0,t.jsx)("p",{className:"text-gray-600 text-sm",children:"Please enter your delivery address to continue."})]}),(0,t.jsx)("button",{onClick:()=>c("new"),className:"bg-primary-600 text-white px-6 py-3 rounded-md hover:bg-primary-700 transition-colors",children:"Enter Delivery Address"})]}),r&&(0,t.jsx)("div",{className:"flex justify-center pt-4",children:(0,t.jsx)("button",{onClick:r,className:"text-gray-600 hover:text-gray-800 text-sm",children:"Cancel Order"})})]})}var n=r(9295),c=r(9099),o=r(9376);function x(){let{session:e,loading:s}=(0,a.a)(),{items:r,total:d,checkout:x}=(0,c.j)(),[m,h]=(0,l.useState)(null),[u,y]=(0,l.useState)(!1);(0,l.useEffect)(()=>{s||e||(0,o.redirect)("/sign-in")},[e,s]),(0,l.useEffect)(()=>{s||0!==r.length||(0,o.redirect)("/cart")},[r,s]);let p=async()=>{if(m){y(!0);try{await x(m)}catch(e){console.error("Checkout error:",e)}finally{y(!1)}}},j=d+2.99;return s?(0,t.jsxs)("div",{className:"min-h-screen",children:[(0,t.jsx)(n.h,{}),(0,t.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-500"})})]}):e&&0!==r.length?(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,t.jsx)(n.h,{}),(0,t.jsxs)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-8",children:"Checkout"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,t.jsx)("div",{className:"space-y-6",children:(0,t.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:m?(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Delivery Address Confirmed"}),(0,t.jsx)("button",{onClick:()=>h(null),className:"text-sm text-primary-600 hover:text-primary-700",children:"Change Address"})]}),(0,t.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:(0,t.jsxs)("div",{className:"flex items-start",children:[(0,t.jsx)("div",{className:"flex-shrink-0",children:(0,t.jsx)("span",{className:"text-green-600",children:"✓"})}),(0,t.jsxs)("div",{className:"ml-3",children:[(0,t.jsx)("p",{className:"font-medium text-gray-900",children:m.customerName}),(0,t.jsxs)("p",{className:"text-gray-600",children:["\uD83D\uDCDE ",m.phone]}),(0,t.jsx)("p",{className:"text-gray-600",children:m.address}),(0,t.jsx)("p",{className:"text-gray-600",children:[m.city,m.province,m.postalCode].filter(Boolean).join(", ")}),(0,t.jsx)("p",{className:"text-gray-600",children:m.country}),m.instructions&&(0,t.jsxs)("p",{className:"text-gray-600 text-sm mt-2",children:[(0,t.jsx)("strong",{children:"Instructions:"})," ",m.instructions]})]})]})})]}):(0,t.jsx)(i,{onAddressSelected:e=>{h(e)},onCancel:()=>(0,o.redirect)("/cart")})})}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Order Summary"}),(0,t.jsx)("div",{className:"space-y-4",children:r.map(e=>(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-gray-100 rounded-lg flex items-center justify-center",children:(0,t.jsx)("span",{className:"text-2xl",children:"\uD83C\uDF55"})}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("h4",{className:"font-medium text-gray-900",children:e.product.name}),(0,t.jsxs)("p",{className:"text-sm text-gray-600",children:["Size: ",e.size," | Qty: ",e.quantity]})]}),(0,t.jsx)("div",{className:"text-right",children:(0,t.jsxs)("p",{className:"font-medium text-gray-900",children:["$",(e.product.price*e.quantity).toFixed(2)]})})]},e.id))}),(0,t.jsxs)("div",{className:"border-t border-gray-200 mt-6 pt-6 space-y-2",children:[(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsx)("span",{children:"Subtotal"}),(0,t.jsxs)("span",{children:["$",d.toFixed(2)]})]}),(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsx)("span",{children:"Delivery Fee"}),(0,t.jsxs)("span",{children:["$","2.99"]})]}),(0,t.jsx)("div",{className:"border-t border-gray-200 pt-2",children:(0,t.jsxs)("div",{className:"flex justify-between font-medium text-lg",children:[(0,t.jsx)("span",{children:"Total"}),(0,t.jsxs)("span",{children:["$",j.toFixed(2)]})]})})]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,t.jsx)("button",{onClick:p,disabled:!m||u,className:"w-full py-3 px-4 rounded-md font-medium text-white transition-colors ".concat(m&&!u?"bg-primary-600 hover:bg-primary-700":"bg-gray-300 cursor-not-allowed"),children:u?"Processing...":m?"Place Order - $".concat(j.toFixed(2)):"Please select delivery address"}),m&&!u&&(0,t.jsx)("p",{className:"text-sm text-gray-600 text-center mt-3",children:"You will be redirected to payment processing"})]})]})]})]})]}):null}}},function(e){e.O(0,[215,33,648,137,824,99,665,971,117,744],function(){return e(e.s=3252)}),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[178],{8595:function(e,s,a){Promise.resolve().then(a.bind(a,1380))},1380:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return x}});var t=a(7437),d=a(389),l=a(2556),r=a(9295),i=a(1192),n=a(5526),c=a(9376),o=a(2265),m=a(9064);function x(){let{session:e,profile:s,loading:a}=(0,i.a)(),[x,u]=(0,o.useState)(!1),[h,p]=(0,o.useState)(!1);(0,o.useEffect)(()=>{a||e||(0,c.redirect)("/sign-in")},[e,a]);let f=async()=>{let{error:e}=await n.O.auth.signOut();e&&console.error("Error signing out:",e)},y=async s=>{p(!0);try{let{error:a}=await n.O.from("profiles").update({full_name:s.customerName,phone:s.phone,default_address:s.address,default_city:s.city,default_province:s.province,default_postal_code:s.postalCode,default_country:s.country,updated_at:new Date().toISOString()}).eq("id",null==e?void 0:e.user.id);if(a)throw a;m.ZP.success("Address saved successfully!"),u(!1),window.location.reload()}catch(e){console.error("Error saving address:",e),m.ZP.error("Failed to save address")}finally{p(!1)}};return a?(0,t.jsxs)("div",{className:"min-h-screen",children:[(0,t.jsx)(r.h,{}),(0,t.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-500"})})]}):e?(0,t.jsxs)("div",{className:"min-h-screen",children:[(0,t.jsx)(r.h,{}),(0,t.jsxs)("main",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-8",children:"Profile"}),(0,t.jsxs)("div",{className:"space-y-8",children:[(0,t.jsxs)("div",{className:"bg-white shadow overflow-hidden sm:rounded-lg",children:[(0,t.jsxs)("div",{className:"px-4 py-5 sm:px-6",children:[(0,t.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Account Information"}),(0,t.jsx)("p",{className:"mt-1 max-w-2xl text-sm text-gray-500",children:"Your account details and preferences."})]}),(0,t.jsx)("div",{className:"border-t border-gray-200",children:(0,t.jsxs)("dl",{children:[(0,t.jsxs)("div",{className:"bg-gray-50 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6",children:[(0,t.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:"Email"}),(0,t.jsx)("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2",children:e.user.email})]}),(0,t.jsxs)("div",{className:"bg-white px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6",children:[(0,t.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:"Role"}),(0,t.jsx)("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2",children:(null==s?void 0:s.group)==="ADMIN"?"Administrator":"Customer"})]}),(0,t.jsxs)("div",{className:"bg-gray-50 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6",children:[(0,t.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:"Member since"}),(0,t.jsx)("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2",children:new Date(e.user.created_at).toLocaleDateString()})]})]})})]}),(0,t.jsxs)("div",{className:"bg-white shadow overflow-hidden sm:rounded-lg",children:[(0,t.jsx)("div",{className:"px-4 py-5 sm:px-6",children:(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Delivery Address"}),(0,t.jsx)("p",{className:"mt-1 max-w-2xl text-sm text-gray-500",children:"Your default delivery address for orders."})]}),!x&&(0,t.jsx)(l.Z,{onClick:()=>u(!0),variant:"outline",text:(null==s?void 0:s.default_address)?"Edit Address":"Add Address"})]})}),(0,t.jsx)("div",{className:"border-t border-gray-200 p-6",children:x?(0,t.jsx)(d.Z,{initialData:{customerName:(null==s?void 0:s.full_name)||"",phone:(null==s?void 0:s.phone)||"",address:(null==s?void 0:s.default_address)||"",city:(null==s?void 0:s.default_city)||"",province:(null==s?void 0:s.default_province)||"ON",postalCode:(null==s?void 0:s.default_postal_code)||"",country:(null==s?void 0:s.default_country)||"Canada"},onSubmit:y,onCancel:()=>u(!1),submitText:"Save Address",loading:h}):(null==s?void 0:s.default_address)?(0,t.jsx)("div",{className:"space-y-2",children:(0,t.jsxs)("div",{className:"text-sm",children:[(0,t.jsx)("p",{className:"font-medium text-gray-900",children:s.full_name||"Your Name"}),s.phone&&(0,t.jsxs)("p",{className:"text-gray-600",children:["\uD83D\uDCDE ",s.phone]}),(0,t.jsx)("p",{className:"text-gray-600",children:s.default_address}),(0,t.jsx)("p",{className:"text-gray-600",children:[s.default_city,s.default_province,s.default_postal_code].filter(Boolean).join(", ")}),s.default_country&&(0,t.jsx)("p",{className:"text-gray-600",children:s.default_country})]})}):(0,t.jsx)("div",{className:"text-center py-8",children:(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("p",{className:"text-gray-600",children:"No default address saved yet."}),(0,t.jsx)("p",{className:"text-gray-600 text-sm",children:"Add an address to speed up future orders."})]})})})]}),(0,t.jsx)("div",{className:"flex justify-end",children:(0,t.jsx)(l.Z,{onClick:f,variant:"outline",text:"Sign Out"})})]})]})]}):null}}},function(e){e.O(0,[215,33,648,137,824,99,665,971,117,744],function(){return e(e.s=8595)}),_N_E=e.O()}]);